(window.webpackJsonp=window.webpackJsonp||[]).push([[40],{537:function(e,t,s){"use strict";s.r(t);var r=s(6),n=Object(r.a)({},(function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[s("p",[e._v("Today I set up a docker environment in the computer room and found that the internal container does not have the ability to connect to the external network. It turns out that the mtu of the network in the computer room is "),s("code",[e._v("1450")]),e._v(", not the default value "),s("code",[e._v("1500")]),e._v(" by docker.")]),e._v(" "),s("p",[e._v("This article will show how to change MTU to "),s("code",[e._v("1450")]),e._v(" for the Docker network.")]),e._v(" "),s("h2",{attrs:{id:"configure-docker-service-file"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#configure-docker-service-file"}},[e._v("#")]),e._v(" Configure docker.service file")]),e._v(" "),s("ol",[s("li",[e._v("Find out "),s("code",[e._v("docker.service")]),e._v(" path")])]),e._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[e._v("sudo")]),e._v(" systemctl status docker.service "),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("|")]),e._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("grep")]),e._v(" Loaded\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br")])]),s("ol",{attrs:{start:"2"}},[s("li",[e._v("Edit "),s("code",[e._v("docker.service")])])]),e._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[e._v("vi")]),e._v(" /lib/systemd/system/docker.service\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[e._v("## add '--mtu=1450' at ExecStart line")]),e._v("\n\n"),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[e._v("ExecStart")]),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v("/usr/bin/dockerd --mtu"),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[e._v("1450")]),e._v(" -H fd:// --containerd"),s("span",{pre:!0,attrs:{class:"token operator"}},[e._v("=")]),e._v("/run/containerd/containerd.sock \n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br"),s("span",{staticClass:"line-number"},[e._v("2")]),s("br"),s("span",{staticClass:"line-number"},[e._v("3")]),s("br"),s("span",{staticClass:"line-number"},[e._v("4")]),s("br"),s("span",{staticClass:"line-number"},[e._v("5")]),s("br")])]),s("ol",{attrs:{start:"3"}},[s("li",[e._v("Service reload")])]),e._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[e._v("sudo")]),e._v(" systemctl daemon-reload\n"),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("sudo")]),e._v(" systemctl start docker\n"),s("span",{pre:!0,attrs:{class:"token function"}},[e._v("sudo")]),e._v(" systemctl restart docker\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br"),s("span",{staticClass:"line-number"},[e._v("2")]),s("br"),s("span",{staticClass:"line-number"},[e._v("3")]),s("br")])]),s("ul",[s("li",[s("code",[e._v("mtu")]),e._v(" config cannot appear at the same time in "),s("code",[e._v("/etc/docker/daemon.json")]),e._v(" and "),s("code",[e._v("docker.service")]),e._v(", it will CRASH!!")])]),e._v(" "),s("h2",{attrs:{id:"references"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#references"}},[e._v("#")]),e._v(" References")]),e._v(" "),s("ul",[s("li",[s("a",{attrs:{href:"https://success.mirantis.com/article/using-systemd-to-control-the-docker-daemon",target:"_blank",rel:"noopener noreferrer"}},[e._v("Using systemd to control the Docker daemon"),s("OutboundLink")],1)]),e._v(" "),s("li",[s("a",{attrs:{href:"https://www.civo.com/learn/fixing-networking-for-docker",target:"_blank",rel:"noopener noreferrer"}},[e._v("Fixing networking for Docker"),s("OutboundLink")],1)]),e._v(" "),s("li",[s("a",{attrs:{href:"https://www.shuzhiduo.com/A/LPdoNOn253/",target:"_blank",rel:"noopener noreferrer"}},[e._v("shuzhiduo - docker修改docker0 mtu"),s("OutboundLink")],1)]),e._v(" "),s("li",[s("a",{attrs:{href:"https://my.oschina.net/u/4342956/blog/3919638",target:"_blank",rel:"noopener noreferrer"}},[e._v("https://my.oschina.net/u/4342956/blog/3919638"),s("OutboundLink")],1)])])])}),[],!1,null,null,null);t.default=n.exports}}]);